# 每日朋友圈助手 · 产品需求文档（PRD v1）

版本：v1.0（草案）
作者：Codex 助手（基于现有简要需求整理）
最后更新：2025-10-08

---

## 1. 产品概述

- 产品定位：面向希望持续经营个人品牌/业务推广/社交影响力的用户，提供“每日朋友圈创作助手”。核心能力是基于用户上传的图片与人设偏好，自动生成有灵魂的中文文案（可调风格），并输出适配微信朋友圈的图文与版式，支持一键复制/导出及提醒定期发圈。
- 目标平台：网站 Web（PC 与移动端 H5，响应式）。首期不做自动代发；用户通过“生成→复制/下载→手动发布”完成发圈。
- 目标用户：自由职业者、内容创作者、自媒体/微商从业者、中小商户运营者、个人 IP 经营者。
- 竞品/灵感：PiPiGPT/BibiGPT（参考链接见备注），各类“文案助手”“修图加字”工具站。

## 2. 业务目标与指标

- P0 目标：
  - 降低发圈创作门槛，让“日更”变简单（TTV<60s：从导入图→出文案→成图/复制）。
  - 生成文案“像我说话”，风格匹配人设，具备时效性话题/梗点能力。
- 核心指标（首版）：
  - 次日留存率 ≥ 30%
  - 人均日生成次数 ≥ 3
  - 单次生成→复制/导出转化率 ≥ 60%
  - 首周订阅/付费转化（若开启）≥ 3%

## 3. 用户画像与关键场景

- 用户画像：
  - 画像 A：独立从业者/微商，主打产品推广+生活方式种草；高频发圈但时间紧。
  - 画像 B：个人 IP 经营者，注重内容风格统一、人设强化与时效话题跟进。
- 关键场景：
  - 每日打卡：早上/晚上快速发一条（健身、读书、工作、产品上新）。
  - 活动/节点：节日、热点、行业事件，需快速跟梗跟话题。
  - 批量备稿：为本周/本月做内容备份与定时提醒。

## 4. 范围与版本拆解

- v1（6 周）：
  - 图片上传/选择，AI 生成文案（多风格候选），可一句话调教“更活泼/更专业/更短/更长”。
  - 受众画像/人设配置（基础）：用户可选择或简单配置语气、身份、受众偏好。
  - 热点梗库（服务端管理+日更离线包下发）：自动融入时效性梗点（可开关）。
  - 图像优化（服务端渲染）：为图片加字（模板/贴纸/滤镜/氛围感）；可输出九宫格切图；导出 1:1/4:5/16:9。
  - 一键复制文案（Clipboard API）；图片/九宫格下载；内容归档与历史记录。
  - 账号体系（轻量）：支持游客模式；手机号验证码登录，可选绑定微信/支付宝用于支付识别；云端同步历史与配置。
  - 商业化首版：订阅/点数体系与支付链路（微信扫码/支付宝网页）。
- v1.5：
  - 自定义模板市场、品牌色/字体管理、风格包。
  - 受众细分/AB 实验建议词；简单数据看板（复制率/导出率/生成词云）。
- v2：
  - 工作流/批量任务、团队模板共享、自动话题日历。

## 5. 核心功能需求（v1）

1) 图片上传与分析
- 支持相册选图与拍照（移动端）；支持多图（最多 9 张）；首图作为主图分析。
- 视觉理解：识别场景/主体/品牌/文字（OCR）→ 作为文案草料。

2) AI 文案生成
- 输入：图片理解结果 + 人设配置 + 受众画像 + 热点梗库片段 + 用户一句话意图（可选）。
- 输出：3–5 条候选文案，支持风格切换（专业/活泼/治愈/幽默/冷淡等）。
- 微调操作：用户可用自然语言“更短/多表情/少营销/更接地气”进行再生成。
- 文案格式：
  - 自动分段、表情/emoji 点缀、可选标签/话题（如城市/节日/行业话题）。
  - 超长自动分段，避免朋友圈折叠；支持“带标题”的样式。

3) 热点梗库
- 内置一份离线热梗/热词数据（随版本更新），并由服务端定期增量更新。
- 文案生成时自动检索匹配当日/当周话题，遵守敏感词规避策略；用户可关闭。

4) 图像优化与排版（服务端渲染）
- 模板：常用排版模板（图上文/图下文/左图右文/贴纸风），可调整主色、透明度、边距。
- 字体与风格：提供若干可商用字体；字号/行距/行宽自适配。
- 九宫格切图：一键切 3x3 输出；保证关键主体不被切断（基于人脸/主体检测）。
- 导出：JPG/PNG；分辨率预设（1080x1080、1350x1080 等）适配朋友圈。

5) 一键复制与导出（Web）
- 复制：一键复制文案到剪贴板。
- 导出：保存图片/九宫格到相册；支持同时生成多张分发图（配不同文案小差异）。

6) 人设与受众画像
- 人设配置：身份（如设计师/健身教练/咖啡主理人）、语气、禁用词、品牌关键词。
- 受众画像：面向谁（同城/宝妈/职场/二次元等），语气与梗点适配。

（本版本不包含“发圈提醒/灵感卡”功能）

8) 历史与收藏
- 最近 30 天生成记录；可收藏优秀文案与图；支持再次编辑出新版本。

9) 账号与同步
- 游客模式：未登录也可生成与导出（本地存储保留最近记录，清缓存即清除）。
- 登录：手机号（验证码），可选绑定微信/支付宝账号用于支付与身份统一。
- 云同步：人设配置、受众画像、收藏与历史记录。

10) 合规与内容安全
- 本地/服务端双层敏感词与合规模型；违规提示与替代建议。

## 6. 非功能需求

- 性能（Web）：
  - 首屏可交互（TTI）P50 < 1.5s，P95 < 2.5s（CDN+SSR 命中场景）；
  - 单次生成 < 5s（含图像分析与文案）。
- 可用性：核心流程 3 步内完成（选图→挑文案→导出/复制）。
- 可靠性：失败可重试，生成超时兜底给 1–2 条模板文案。
- 兼容性：现代浏览器（Chrome/Edge/Safari/Firefox 最近 2 个大版本），移动端 H5 适配。
- 隐私：图片与文案仅用于生成与历史留存；支持“一键清空历史”与“一键导出数据”。默认云端保存周期按现有隐私策略执行（若无特殊要求，建议 90 天）。
- 交付与加速：国内云厂商对象存储+CDN 加速，后端可用性 ≥ 99.9%。

## 7. 技术选型（建议）

- 后端：Java（Spring Boot 3.x）+ Spring Security + JPA/MyBatis；内置任务调度（Quartz/Scheduler）。
- AI 能力（国内优先）：
  - 文案生成：优先接入国内商用大模型（阿里通义千问、百度文心、智谱 GLM、月之暗面 Kimi、科大讯飞星火等）；抽象 LLM Provider 以便切换与熔断降级。
  - 视觉理解：多模态/图像 Caption（国内厂商 API）或服务端 OCR+Tagging 组合。
  - （本版不接入内容安全/违禁词审核，保留扩展接口位）
- 图像处理（服务端为主）：
  - 模板渲染合成图：ImageMagick/GraphicsMagick 或 Java 图像库（imgscalr/Thumbnailator）。
  - 九宫格切图、贴纸/滤镜、描边与自适应排版在服务端完成，确保一致性。
- 前端（网站）：
  - React + Next.js（SSR/SR 混合）或 Vue + Nuxt；Tailwind/UnoCSS 按现有品牌规范落地；
  - 使用 Clipboard API 一键复制；支持 PWA（可选）以离线缓存热点梗与基础 UI。
- 支付与商业化：
  - 微信支付（Native 扫码/JSAPI）、支付宝网页支付（WAP/PC）；首期可引入兑换码通道降低集成风险。
- 存储与基础设施：
  - 关系型数据库（MySQL/PostgreSQL）存用户、配置、历史；
  - 对象存储（阿里云 OSS/腾讯云 COS）存图片与导出图；
  - KV 缓存（Redis）存热点梗、提示词片段与生成上下文；
  - CDN（阿里云/腾讯云）加速静态与导出资源。

## 8. 系统架构与模块

- 网关/鉴权：API 网关 + JWT 会话；限流与灰度开关。
- 生成服务：LLM Orchestrator（提示工程、重写与风格控制、梗点注入、合规模块）。
- 热点梗服务：离线包管理 + 增量更新（按日），本地缓存与版本回滚。
- 图像服务：OCR/Tagging、模板渲染、九宫格切图。
- 内容安全：文本/图片审核流水线，失败兜底替换策略。
  - （不包含提醒相关模块）

## 9. API 概要（示例）

- `POST /api/v1/auth/login` 手机号登录/验证码校验
- `GET /api/v1/profile` 获取人设与受众画像
- `PUT /api/v1/profile` 更新人设与受众画像
- `POST /api/v1/generate/caption` 上传图片（URL 或直传）→ 图像理解结果
- `POST /api/v1/generate/copy` 输入：imageTags、persona、audience、tone、hotTopics → 文案候选
 - `POST /api/v1/generate/rewrite` 根据指令微调（shorter/funnier/less-salesy 等）
 - `POST /api/v1/image/render` 模板参数 → 合成图/九宫格
 - `GET /api/v1/history` 历史生成记录（分页）
 - `POST /api/v1/favorites` 收藏/取消收藏
 - `GET /api/v1/hot-topics` 获取今日热点梗词（含版本号）
  - `POST /api/v1/auth/anonymous` 生成游客令牌（匿名会话）
  - `POST /api/v1/billing/orders` 创建订单（订阅/点数）
  - `GET /api/v1/billing/orders/{id}` 查询订单状态
  - `POST /api/v1/billing/callback/{channel}` 支付回调（微信/支付宝）

## 10. 数据模型（草案）

- User(id, phone, wechatOpenId, createdAt, …)
- Persona(userId, role, tone, brandKeywords[], bannedWords[], audienceTags[])
- Generation(id, userId, imageId, copy[], selectedCopy, tags[], createdAt)
- Image(id, userId, originUrl, derivedUrls[], ocrText, labels[], createdAt)
- HotTopic(version, date, keywords[], examples[])
- Favorite(id, userId, generationId)
 - （无提醒模型）
 - Order(id, userId, channel, planId, amount, currency, status, createdAt, paidAt)
 - Plan(id, name, quotaPerDay, features[], price)
 - Entitlement(id, userId, planId, expiresAt, remainingQuota)
 - AnonymousSession(id, deviceFingerprint, createdAt, expiresAt)

## 11. 提示工程（示例要点）

- 系统提示：你是资深中文社交文案创作者，风格匹配{persona}，受众{audience}，避免{bannedWords}。
- 上下文：图像识别结果（主体/场景/品牌/OCR 文本）、热点梗（可选）、品牌关键词。
- 目标：给出 3–5 条朋友圈文案，长度 30–120 字，适当使用 emoji，避免违禁词，输出 JSON 结构。
- 微调指令：更短、更专业、更生活化、加一点押韵、少营销、去口号化。

（本版本不做内容安全与违禁词处理）

## 13. 商业化与计费（v1 开启）

- 模式：
  - Freemium：每日免费 3 次生成（游客/登录均适用，登录可同步历史）。
  - 订阅：解锁去水印/高阶模板/更多风格/更高分辨率/批量导出/热点优先通道。
  - 点数制：按生成/图像渲染计点；新手礼包与签到送点。
- 支付通道：
  - 微信支付（Native 扫码/JSAPI）与支付宝网页支付（WAP/PC）。首期支持兑换码作为备选方案。
- 使用与风控：
  - 限流与防刷：基于 IP/设备指纹/匿名会话与账号维度；
  - 失败回滚：订单支付异常时自动回退额度与状态。

## 14. 埋点与指标

- 关键事件：打开 App、选图、生成成功、复制、导出、收藏、微调再生、提醒点击、订阅转化。
- 质量指标：平均生成用时、合规拦截率、用户重写次数/次生成候选被选中率。
 - 质量指标：平均生成用时、用户重写次数/次生成候选被选中率。
 - 商业化指标：订单创建转化率、支付成功率、订阅留存、游客→注册转化率。

## 15. 里程碑（6 周）

- 第 1 周：需求确认与品牌规范对齐；UI 设计与组件库；技术选型与骨架搭建（Next/Nuxt + Spring Boot）。
- 第 2 周：AI 生成链路（图片上传→视觉解析→文案候选→重写器）；LLM Provider 抽象与国内厂商接入。
- 第 3 周：服务端图像渲染（模板/贴纸/滤镜/九宫格/导出）；热点梗服务（日更）与合规模块接入。
- 第 4 周：账号（游客/手机号登录）、历史/收藏；埋点与数据面板（基础）。
- 第 5 周：商业化（订阅/点数、订单与支付回调、额度发放）、CDN/缓存/限流。
- 第 6 周：联调与性能优化；小范围灰度；文案与模板库完善；上线。

## 16. 验收标准（v1）

- 30s 内完成一次完整流程（选图→文案→导出/复制）。
- 文案主观可用率 ≥ 80%（内测问卷与标注）；
- 热点梗融合自然，无明显“生硬植入”；
- 九宫格切图主体完整率 ≥ 95%；
  

## 17. 风险与应对

- 模型风格稳定性不足 → 增加风格控制提示词与候选多样化、重写器。
- 热点梗时效性 → 本地离线包 + 服务端日更，带版本回滚。
- 图像文字可读性 → 动态测量对比度/字号/行距；模板自适应；暗色描边。
- 微信生态限制 → 不做自动代发；优化“复制/保存相册”路径与教学。

## 18. 备注

- 参考：https://bibigpt.co/pipigpt?ref=aihub.cn
- 约束：后端使用 Java 技术栈；需考虑国内可用的大模型与合规方案。

---

## 19. 决策回顾（已确认）

- 目标平台：网站 Web（响应式）。
- 模型供应商：国内优先（支持多家切换）。
- 图像处理：服务端渲染为主。
- 热点梗数据：由我们制定方案（服务端日更+离线包），运营可选辅助。
- 商业化：v1 即开启（订阅/点数）。
- 账号：支持游客模式；手机号登录可选，支持支付账号绑定。
- 企业级风控审计：暂不考虑（保留扩展位）。
- 不包含：发圈提醒、违禁词/内容安全。
- 设计：已有品牌规范（按现有规范落地）。
- 隐私：存在保存与清空/导出要求（PRD 已纳入）。
- 时间线/MVP：采用 6 周节奏与范围（如上）。

---

## 19. 待确认问题（请明确）

1) 目标平台优先级：微信小程序、原生 App、还是移动 H5？
2) 大模型供应商偏好与预算：是否要求国内厂商优先？是否需要多家切换容灾？
3) 图像处理侧重：更多在端上（更快）还是服务端（更统一）？
4) 热点梗数据来源：是否可自建采集（需要运营支持），更新频率与审核流程？
5) 商业化时机：v1 是否开启订阅/点数，定价区间？
6) 账号体系：是否必须微信登录？是否支持游客模式/本地使用？
7) 合规侧：是否需要企业级风控与留痕审计（影响架构与成本）？
8) 设计规范：是否已有品牌色/LOGO/视觉规范？
9) 数据与隐私：图片/文案默认云端保存周期？是否提供“一键清空与导出”能力？
10) 里程碑：上线目标时间与最小可用范围（MVP 定义）？
